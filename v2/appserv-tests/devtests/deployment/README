UNIT TESTS ON DEPLOYMENT
========================

TESTS INFO :
------------

1. war/* are tests that deploy WAR module only. The name of directories indicate
   what kind of WAR each tests build for deployment

2. ejb/* are tests that deploy EJB-JARs only

3. ear/* are tests that deploy EAR with WAR only, EAR with EJBJAR only, EAR
   with WAR and EJBJAR, EAR with webservice

4. jsr88/* are tests that test other jsr88 APIs like get*Modules etc 

5. In all totally 83 unit test cases will be executed

FOR RUNNING THE DEPLOYMENT TESTS ON PE :
----------------------------------------

0. Please make sure if you have the following env. variable set at all, they
   need to be in the following values:
   SECURE=false
   DEPL_TARGET=PE
   Nothing needs to be done if you don't have those env. var set.
   The following setup is need to run annotation tests.

1. Start the domain.

2. Start the derby database.

2. Simply type "ant all" from appserv-tests/devtests/deployment.  At the end 
   of the run, in the above mentioned directory two files are created : 
   result.html has the result of each test; client.log has all output from test run

3. To run individual tests, go to the test directory and type "ant all". For 
   example, to run ejb/webservice test "cd ejb/webservice" and do "ant all".
   The results.html and client.log are created in ejb/webservice directory

4. If you use "asant" that comes with the appserver to run all tests, there is
   a known problem in ant because of which some stack overflow happens. Use of
   ant1.6 is recommended

READING RESULTS :
-----------------

1. result.html will state whether a particular test passed or failed. This
   file just has a summary of the test results.
2. client.log has all detailed outputs of all the deployment unit
   tests. This file HAS TO BE CHECKED to ensure that no exception
   (specifically those from MBeans etc were thrown). Search for 'exception'
   in this file to ensure no uncaught exceptions were thrown.

Notes about redeploy tests
--------------------------

1. When adding new test, should also add redeploy test for that.
2. Assume redeploy test always run after deploy test, so we don't need to 
   call undeploy after the deploy test, and only need to call deploy once
   for redeploy test.

Overcoming 'ant' compile problem :
----------------------------------
In some cases the ant test clients run out of memory during the test run.
To avoid this problem, add -Xmx999m to the command that starts the ant java vm

Here is how to do that :

cat `which ant` :

(... go towards bottom of ant script and add the option -Xmx999m as shown below)

 "$JAVACMD" -Xmx999m -classpath "$LOCALCLASSPATH" -Dant.home="${ANT_HOME}" $ANT_OPTS org.apache.tools.ant.Main $ANT_ARGS "$@"

For help contact s1as-deployment-dev@sun.com
