<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html><!-- GenHTML@12751-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<!-- ident	"%Z%%M%	%I%	%E% SMI" -->

    <title>20.&nbsp;&nbsp;Compiling and Configuring Apache Web Server
    </title>
</head>
<body>
<font style="color: red; font-family:arial,helvetica,sans-serif; font-size:12pt; font-weight:bold}">Not For Publication</font>&nbsp;&nbsp;&nbsp;<br>Glassfish Review Draft<br> </td>

<A href="toc.html">Sun Java System Application Server Platform Edition 9 Administration Guide</A>&nbsp;<br>
<A HREF="ablwj.html">Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="ablwx.html">Next</A><br>
            <!--startindex--><A NAME="ablws"></A><b>Chapter&nbsp;20</b><h1>Compiling and Configuring Apache Web Server</h1>
<p>This appendix describes how to compile the Apache source code and configure
an installation of Apache Web Server to use the Sun Java System Application Server load
balancer plug-in.</p>
<p>Download the appropriate Apache source code. For information about the versions
and platforms of Apache Web Server supported for the Application Server, see the<i>Application Server Release
Notes</i>.</p>
<p>This appendix contains the following topics:</p>
<ul><li><p><A HREF="ablws.html#ablwt">Installing Apache</A></p>
</li>
</ul>
<A NAME="ablwt"></A><h2>Installing Apache</h2>
<p>This section contains the following topics:</p>
<ul><li><p><A HREF="ablws.html#ablwu">Minimum Requirements for Apache 1.3</A></p>
</li>
<li><p><A HREF="ablws.html#ablwv">Minimum Requirements for Apache 2</A></p>
</li>
<li><p><A HREF="ablws.html#ablww">To install SSL-aware Apache</A></p>
</li>
</ul>
<A NAME="ablwu"></A><h3>Minimum Requirements for Apache 1.3</h3>
<p>This section describes the minimum requirements to successfully compile Apache
1.3 web server to run the load balancer plug-in. The Apache source must be compiled
and built to run with SSL.</p>
<p>Requirements for UNIX and Linux platforms:</p>
<p><A NAME="indexterm-370"></A>For
requirements on Microsoft Windows platforms, see <A HREF="http://httpd.apache.org/docs/windows.html#req http://httpd.apache.org/docs/win_compiling.html">http://httpd.apache.org/docs/windows.html#req http://httpd.apache.org/docs/win_compiling.html</A>.</p>
<p>Requirements for other platforms:</p>
<ul><li><p><tt>openssl-0.9.7</tt><tt>d</tt> (source)</p>
</li>
<li><p><tt>mod_ssl-2.8.16-1.3.29</tt> (source)</p>
</li>
<li><p><tt>apache_1.3.29</tt> (sources)</p>
</li>
<li><p><tt>gcc-3.3-sol9-sparc-local packages</tt> (for Solaris
9 SPARC/x86).</p>
</li>
<li><p><tt>flex-2.5.4a-sol9-sparc-local</tt> packages (for Solaris
9 SPARC)</p>
</li>
<li><p><tt>flex-2.5.4a-sol9-intel-local</tt> packages (for Solaris
9 x86)</p>
</li>
</ul>
<p>In addition, before compiling Apache:</p>
<ul><li><p>On Linux, install the Sun Java System Application Server on the same machine.</p>
</li>
<li><p>On Solaris 8, ensure that <tt>gcc</tt> and <tt>make</tt> are in the <tt>PATH</tt>.</p>
</li>
<li><p>On Solaris 9, ensure that <tt>gcc</tt> version 3.3 and <tt>make</tt> are in the <tt>PATH</tt>, and <tt>flex</tt> is
installed.</p>
</li>
<li><p>If you are using <tt>gcc</tt> on Red Hat Enterprise Linux
Advanced Server 2.1, the version must be later than <tt>gcc</tt> 3.0.</p>
</li>
</ul>
<p><hr size="1" noshade><ul><li><p><b>Note - </b>To use another C compiler, set the path of the C compiler and make
utility in the PATH environment variable. For example:</p>
<p>export <tt>LD_LIBRARY_PATH=$LD_LIBRARY_PATH:</tt><i>install-dir</i><tt>/lib</tt></p>
</li>
<li><p>These software sources are available at <A HREF="http://www.sunfreeware.com">http://www.sunfreeware.com</A>.</p>
</li>
</ul>
<hr size="1" noshade></p><A NAME="ablwv"></A><h3>Minimum Requirements for Apache 2</h3>
<p>This section describes the minimum requirements to successfully compile Apache
2 web server to run the load balancer plug-in. The Apache source must be compiled
and built to run with SSL.</p>
<p>Requirements for UNIX and Linux platforms:</p>
<p><A NAME="indexterm-371"></A>For
requirements on Microsoft Windows platforms, see <A HREF="http://httpd.apache.org/docs-2.0/platform/windows.html">http://httpd.apache.org/docs-2.0/platform/windows.html</A>.</p>
<p>Requirements for other platforms:</p>
<ul><li><p><tt>openssl-0.9.7e (source)</tt></p>
</li>
<li><p><tt>httpd-2.0.49 (source)</tt></p>
</li>
<li><p><tt>gcc-3.3-sol9-sparc-local</tt> packages (for Solaris
SPARC).</p>
</li>
<li><p><tt>gcc-3.3-sol9-intel-local</tt> packages (for Solaris
x86)</p>
</li>
<li><p><tt>flex-2.5.4a-sol9-sparc-local</tt> packages (for Solaris
SPARC)</p>
</li>
<li><p><tt>flex-2.5.4a-sol9-intel-local</tt> packages (for Solaris
x86)</p>
</li>
</ul>
<p>In addition, before compiling Apache:</p>
<ul><li><p>On the Linux platform, install the Sun Java System Application Server on
the same machine.</p>
</li>
<li><p>On the Solaris operating system, ensure that <tt>gcc</tt> version
3.3 and <tt>make</tt> are in the <tt>PATH</tt>, and <tt>flex</tt> is installed.</p>
</li>
<li><p>On the Solaris 10 operating system, before running <tt>make</tt> for
OpenSSL, run <tt>/usr/local/lib/gcc-lib/sparc-sun-solaris2.9/3.3/install-tools/mkheaders</tt> (Solaris SPARC) or <tt>/usr/local/lib/gcc-lib/i386-pc-solaris2.9/3.3/install-tools/mkheaders</tt> (Solaris x86).</p>
</li>
<li><p>If you are using <tt>gcc</tt> on Red Hat Enterprise Linux
Advanced Server 2.1, the version must be later than <tt>gcc</tt> 3.0.</p>
</li>
</ul>
<p><hr size="1" noshade><ul><li><p><b>Note - </b>To use another C compiler, set the path of the C compiler and make
utility in the PATH environment variable. For example:<tt>export LD_LIBRARY_PATH=</tt><i>install-dir</i><tt>/lib:$LD_LIBRARY_PATH</tt>. This example is for <tt>sh</tt>.</p>
</li>
<li><p>These software sources are available at <A HREF="http://www.sunfreeware.com">http://www.sunfreeware.com</A>.</p>
</li>
</ul>
<hr size="1" noshade></p><A NAME="ablww"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">To install SSL-aware Apache</h3>
<p><A NAME="indexterm-372"></A>For instructions on compiling and installing Apache on Microsoft Windows
platforms, see the following web sites:</p>
<p>Apache 1.3: <A HREF="http://httpd.apache.org/docs/win_compiling.html">http://httpd.apache.org/docs/win_compiling.html</A></p>
<p>Apache 2: <A HREF="http://httpd.apache.org/docs-2.0/platform/win_compiling.html">http://httpd.apache.org/docs-2.0/platform/win_compiling.html</A></p>
<h5>Before You Begin</h5><p>You must have already downloaded and uncompressed the Apache software.</p>
<h5>Steps</h5><ol><li><p><b>Compile and build OpenSSL. For more information about OpenSSL, see <A HREF="http://www.openssl.org/">http://www.openssl.org/</A>.</b></p><p>This step is not required
on the Linux platform if the version of OpenSSL installed with Linux is 0.9.7.e.</p>
<p>Download and unpack the OpenSSL source.</p>
<ol Type="a"><li><p><b><tt>cd openssl-0.9.7e</tt></b></p></li>
<li><p><b><tt>make</tt></b></p></li>
<li><p><b><tt>make install</tt></b></p></li>
</ol>
</li>
<li><p><b>For Apache 1.3, configure Apache with <tt>mod_ssl</tt>. You
do not need to complete this step for Apache 2. For more information about <tt>mod_ssl</tt>, see <A HREF="http://www.modssl.org/">http://www.modssl.org/</A>.</b></p><p>Unpack the <tt>mod_ssl</tt> source and follow these steps.</p>
<ol Type="a"><li><p><b><tt>cd mod_ssl-2.8.14-1.3.x</tt></b></p></li>
<li><p><b>Run <tt>./configure --with-apache=../apache_1.3.</tt><i>x</i> <tt>--with-ssl=../openssl-0.9.7e --prefix=</tt><i>install-dir</i><tt>--enable-module=ssl --enable-shared=ssl --enable-rule=SHARED_CORE --enable-module=so</tt></b></p><p>The directory specified in the above command example is a variable.
The <i>prefix</i> argument indicates where to install Apache.
The <i>x</i> in the version number represents your actual version.</p>
</li>
</ol>
</li>
<li><p><b>For Apache 2.0, configure the source tree:</b></p><ol Type="a"><li><p><b>cd to the <tt>http-2.0_</tt><i>x</i> directory.</b></p></li>
<li><p><b>Run <tt>./configure --with-ssl=</tt><i>open-ssl-install-path</i> <tt>--prefix=</tt><i>install-dir</i> <tt>--enable-ssl --enable-so</tt></b></p><p>The directory specified in the above command example is a variable.
The <i>prefix</i> argument indicates where to install Apache.
The <i>x</i> in the version number represents your actual version.</p>
</li>
</ol>
</li>
<li><p><b>For Apache on Linux 2.1, before compiling:</b></p><ol Type="a"><li><p><b>Open <tt>src/MakeFile</tt> and find the end of the automatically
generated section.                      </b></p></li>
<li><p><b>Add the following lines after the first four lines after the automatically
generated section:</b></p><p><tt>LIBS+= -licuuc -licui18n -lnspr4 -lpthread
-lxerces-c -lsupport -lnsprwrap -lns-httpd40</tt></p>
<p><tt>LDFLAGS+=
-L/</tt><i>install-dir</i><tt>/lib -L/opt/sun/private/lib</tt></p>
<p><hr size="1" noshade><p><b>Note - </b>The <tt>-L/opt/sun/private/lib</tt> part is only required if
you installed Application Server as part of a Java Enterprise System installation.</p>
<hr size="1" noshade></p><p>For example:</p>
<p><tt>##  (End of automatically generated section)##</tt></p>
<p><tt>CFLAGS=$(OPTIM) $(CFLAGS1) $(EXTRA_CFLAGS)LIBS=$(EXTRA_LIBS)
$(LIBS1)INCLUDES=$(INCLUDES1) $(INCLUDES0) $(EXTRA_INCLUDES)LDFLAGS=$(LDFLAGS1) $(EXTRA_LDFLAGS)"</tt></p>
<p><tt>LIBS+= -licuuc -licui18n -lnspr4 -lpthread -lxerces-c
-lsupport -lnsprwrap -lns-httpd40LDFLAGS+= -L/</tt><i>install-dir</i><tt>/lib
-L/opt/sun/private/lib</tt></p>
</li>
<li><p><b>Create an environment variable LD_LIBRARY_PATH equal to: <i>install-dir</i><tt>/lib</tt> (for all installations) and <i>install-dir</i><tt>/lib:opt/sun/private/lib</tt> (for Application Server installed as part of a Java Enterprise System installation).</b></p></li>
</ol>
</li>
<li><p><b>Compile Apache as described in the installation instructions for the version
you are using. Full documentation is at <A HREF="http://httpd.apache.org/">http://httpd.apache.org/</A>.</b></p><p>In general the steps are:</p>
<ol Type="a"><li><p><b><tt>make</tt></b></p></li>
<li><p><b><tt>make certificate</tt> (Apache 1.3 only)</b></p></li>
<li><p><b><tt>make install</tt></b></p><p>The command <tt>make
certificate</tt> asks for a secure password. Remember this password as it is
required for starting secure Apache.</p>
</li>
</ol>
</li>
<li><p><b>Configure Apache for your environment.</b></p><p>Once you have completed
the Apache installation, see "Modifications to Apache Web Server" after
plug-in installation.</p>
</li>
</ol>
            <!--stopindex-->
<br>
<A HREF="ablwj.html">Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="ablwx.html">Next</A>
</body>
</html>
